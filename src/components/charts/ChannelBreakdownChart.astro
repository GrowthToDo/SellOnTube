---
// Doughnut chart showing May 2025 channel breakdown
---

<div class="my-8 p-6 bg-white dark:bg-slate-800 rounded-xl shadow-lg">
  <h3 class="text-xl font-bold text-center mb-4 text-gray-900 dark:text-white">May 2025: Channel Breakdown</h3>
  <div class="relative mx-auto" style="height: 300px; max-width: 400px;">
    <canvas id="channelBreakdownChart"></canvas>
  </div>
  <div class="flex justify-center gap-6 mt-4 text-sm">
    <div class="flex items-center gap-2">
      <span class="w-3 h-3 rounded-full bg-red-600"></span>
      <span class="text-gray-700 dark:text-gray-300">YouTube: <strong>65%</strong></span>
    </div>
    <div class="flex items-center gap-2">
      <span class="w-3 h-3 rounded-full bg-emerald-500"></span>
      <span class="text-gray-700 dark:text-gray-300">ChatGPT: <strong>22%</strong></span>
    </div>
    <div class="flex items-center gap-2">
      <span class="w-3 h-3 rounded-full bg-blue-500"></span>
      <span class="text-gray-700 dark:text-gray-300">Blog: <strong>13%</strong></span>
    </div>
  </div>
</div>

<script>
  import { Chart, DoughnutController, ArcElement, Tooltip, Legend } from 'chart.js';

  Chart.register(DoughnutController, ArcElement, Tooltip, Legend);

  const ctx = document.getElementById('channelBreakdownChart') as HTMLCanvasElement;

  new Chart(ctx, {
    type: 'doughnut',
    data: {
      labels: ['YouTube Videos', 'ChatGPT Referrals', 'Blog'],
      datasets: [{
        data: [142, 47, 29],
        backgroundColor: [
          'rgba(255, 0, 0, 0.9)',
          'rgba(16, 185, 129, 0.9)',
          'rgba(59, 130, 246, 0.9)'
        ],
        borderColor: [
          'rgba(255, 0, 0, 1)',
          'rgba(16, 185, 129, 1)',
          'rgba(59, 130, 246, 1)'
        ],
        borderWidth: 2,
        hoverOffset: 10
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      cutout: '55%',
      plugins: {
        legend: {
          display: false
        },
        tooltip: {
          callbacks: {
            label: function(context) {
              const total = 218;
              const percentage = Math.round((context.parsed / total) * 100);
              return `${context.label}: ${context.parsed} conversions (${percentage}%)`;
            }
          }
        }
      }
    }
  });
</script>
